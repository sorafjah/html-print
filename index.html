<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTMLãƒ—ãƒªãƒ³ãƒˆã‚¨ãƒ‡ã‚£ã‚¿</title>
    <style>
        /* * =========================================
         * ã‚¢ãƒ—ãƒªå…¨ä½“ã®UIãƒ‡ã‚¶ã‚¤ãƒ³ (App UI)
         * =========================================
         */
        :root {
            --primary-color: #0066cc;
            --bg-color: #f4f7fa;
            --text-color: #333;
            --border-color: #dde2e5;
            --paper-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        body {
            font-family: "BIZ UDPGothic", "BIZ UD Pã‚´ã‚·ãƒƒã‚¯", "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            color: var(--text-color);
            overflow: hidden;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            width: 280px;
            background-color: #ffffff;
            border-right: 1px solid var(--border-color);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            box-shadow: 2px 0 5px rgba(0,0,0,0.02);
            z-index: 10;
        }

        .logo {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 5px;
        }

        .tool-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .tool-label {
            font-size: 12px;
            font-weight: bold;
            color: #666;
            margin-bottom: 4px;
        }

        .control-row {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        input[type="number"] {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: inherit;
            width: 60px;
        }

        select {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: inherit;
        }

        button {
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            color: #333;
            user-select: none;
        }

        button:hover {
            background-color: #f0f8ff;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        button.active {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }

        button.primary-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            font-weight: bold;
            padding: 10px;
        }
        button.primary-btn:hover {
            background-color: #0052a3;
        }

        button.sm-btn {
            padding: 4px 8px;
            font-size: 12px;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ */
        .main-area {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            transition: all 0.3s;
            position: relative;
        }

        /* ç”¨ç´™ */
        #paper-container {
            background-color: #fff;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            box-shadow: var(--paper-shadow);
            box-sizing: border-box;
            outline: none;
            position: relative;
        }

        /* Webè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        body.mode-web .sidebar { display: none; }
        body.mode-web .main-area {
            padding: 0;
            background-color: #fff;
            display: block;
        }
        body.mode-web #paper-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            box-shadow: none;
            min-height: 100vh;
        }
        body.mode-web .instruction-banner { display: none !important; }

        .gear-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            color: #555;
            font-size: 24px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            border: 1px solid #ccc;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            transition: transform 0.3s, background 0.3s;
        }
        .gear-btn:hover {
            transform: rotate(90deg);
            background: #fff;
            color: var(--primary-color);
        }
        body.mode-web .gear-btn { display: flex; }

        .instruction-banner {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
            color: #0d47a1;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 14px;
            line-height: 1.5;
        }
        .instruction-banner strong {
            font-size: 16px;
            display: block;
            margin-bottom: 5px;
        }

        /* ã‚½ãƒ¼ã‚¹ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-overlay.open { display: flex; }
        .modal-content {
            background: #fff;
            padding: 20px;
            width: 80%;
            max-width: 600px;
            height: 70%;
            display: flex;
            flex-direction: column;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .modal-header { font-weight: bold; margin-bottom: 10px; font-size: 18px; }
        #htmlSourceInput {
            flex: 1;
            font-family: monospace;
            padding: 10px;
            border: 1px solid #ccc;
            resize: none;
            margin-bottom: 10px;
        }

        /* =========================================
         * ãƒ«ãƒ“ç·¨é›†ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼ˆæ–°è¦è¿½åŠ ï¼‰
         * =========================================
         */
        #ruby-popup {
            position: fixed;
            display: none;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.18);
            padding: 12px 16px;
            z-index: 2000;
            min-width: 220px;
            font-size: 14px;
        }
        #ruby-popup.visible { display: block; }
        #ruby-popup .popup-title {
            font-size: 12px;
            color: #888;
            margin-bottom: 8px;
        }
        #ruby-popup .popup-kanji {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
            text-align: center;
            color: var(--primary-color);
        }
        #ruby-popup input[type="text"] {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #bbb;
            border-radius: 4px;
            font-size: 15px;
            box-sizing: border-box;
            margin-bottom: 10px;
            font-family: inherit;
        }
        #ruby-popup input[type="text"]:focus {
            outline: 2px solid var(--primary-color);
            border-color: var(--primary-color);
        }
        #ruby-popup .popup-btns {
            display: flex;
            gap: 8px;
        }
        #ruby-popup .popup-btns button {
            flex: 1;
            padding: 6px;
            font-size: 13px;
        }
        #ruby-popup .btn-delete {
            background: #fff3f3;
            border-color: #e57373;
            color: #c62828;
        }
        #ruby-popup .btn-delete:hover {
            background: #ffebee;
        }

        /* rubyè¦ç´ ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç¤ºã™ã‚¹ã‚¿ã‚¤ãƒ« */
        #paper-container ruby {
            cursor: pointer;
            border-radius: 2px;
            transition: background 0.15s;
        }
        #paper-container ruby:hover {
            background: rgba(0, 102, 204, 0.08);
        }
        #paper-container ruby.ruby-editing {
            background: rgba(0, 102, 204, 0.15);
            outline: 1px dashed var(--primary-color);
        }

        /* * =========================================
         * å°åˆ·è¨­å®š
         * =========================================
         */
        @media print {
            .sidebar, .gear-btn, .no-print, .instruction-banner, #ruby-popup {
                display: none !important;
            }
            body, .main-area {
                background: none;
                height: auto;
                overflow: visible;
                display: block;
                padding: 0;
                margin: 0;
            }
            #paper-container {
                box-shadow: none;
                width: 100%;
                margin: 0;
                padding: 0;
                border: none !important;
            }
            body.hide-ruby rt { display: none; }
        }

        /* * =========================================
         * ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…éƒ¨ã‚¹ã‚¿ã‚¤ãƒ«
         * =========================================
         */
        [contenteditable]:focus { outline: none; }
        
        #paper-container *:focus {
            outline: 2px dashed rgba(0, 102, 204, 0.3);
            background-color: rgba(0, 102, 204, 0.02);
        }

        body.hide-ruby rt { display: none; }
        .font-mincho { font-family: "BIZ UDMincho", serif !important; }
        .font-gothic { font-family: "BIZ UDPGothic", sans-serif !important; }

        .doc-title { text-align: center; font-size: 24px; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
        .situation-box { background-color: #f9f9f9; padding: 15px; border: 1px solid #000; margin-bottom: 20px; }
        .doc-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        .doc-table th, .doc-table td { border: 1px solid #000; padding: 8px 12px; text-align: center; }
        .doc-table th { background-color: #eee; }
        .question-box { margin-bottom: 25px; }
        .question-title { font-weight: bold; margin-bottom: 10px; }
        .answer-space { border-bottom: 1px dotted #000; display: inline-block; min-width: 200px; height: 1.5em; vertical-align: bottom; }
        .clock-grid { display: flex; justify-content: space-around; flex-wrap: wrap; margin-top: 15px; }
        .clock-item { text-align: center; margin: 10px; }
        canvas { display: block; margin-bottom: 5px; border: 1px solid #eee; background: white; }
        .options { list-style: none; padding: 0; }
        .options li { margin-bottom: 8px; }
        rt { color: #555; }
    </style>
</head>
<body class="font-gothic">

    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <div class="sidebar">
        <div class="logo">ãƒ—ãƒªãƒ³ãƒˆã‚¨ãƒ‡ã‚£ã‚¿</div>

        <!-- ãƒ‡ãƒ¼ã‚¿æ“ä½œ -->
        <div class="tool-group">
            <div class="tool-label">ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</div>
            <button onclick="openSourceModal()" title="HTMLã‚¿ã‚°ã‚’ç›´æ¥è²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã¾ã™">
                ğŸ“„ HTMLã‚½ãƒ¼ã‚¹ã‚’è²¼ä»˜/ç·¨é›†
            </button>
        </div>

        <!-- ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š -->
        <div class="tool-group">
            <div class="tool-label">æ–‡å­—ã®è¨­å®š</div>
            <div class="control-row">
                <button onmousedown="event.preventDefault(); toggleFont('gothic')" id="btn-gothic" class="active">ã‚´ã‚·ãƒƒã‚¯</button>
                <button onmousedown="event.preventDefault(); toggleFont('mincho')" id="btn-mincho">æ˜æœä½“</button>
            </div>
            <div class="control-row" style="margin-top:5px;">
                <button onmousedown="event.preventDefault(); execCmd('bold')" title="å¤ªå­—"><b>B</b></button>
                <input type="number" id="fontSizeInput" value="16" min="8" max="72" title="æ–‡å­—ã‚µã‚¤ã‚º">
                <span style="font-size:12px;">px</span>
            </div>
        </div>

        <!-- ãƒ«ãƒ“è¨­å®š -->
        <div class="tool-group">
            <div class="tool-label">æŒ¯ã‚Šä»®åï¼ˆãƒ«ãƒ“ï¼‰</div>
            <div class="control-row">
                <button onmousedown="event.preventDefault(); setRuby()" style="flex:1;" title="é¸æŠã—ãŸæ–‡å­—ã«ãƒ«ãƒ“ã‚’æŒ¯ã‚Šã¾ã™">
                    ã‚ ãƒ«ãƒ“ã‚’æŒ¯ã‚‹
                </button>
            </div>
            <div style="font-size:10px; color:#666; margin-top:2px;">â€»æ–‡å­—ã‚’é¸æŠã—ã¦ã‹ã‚‰æŠ¼ã—ã¦ãã ã•ã„</div>
            <div style="font-size:10px; color:#0066cc; margin-top:4px; line-height:1.4;">
                ğŸ’¡ æ—¢å­˜ã®ãƒ«ãƒ“ã¯ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†ã§ãã¾ã™
            </div>
            <div style="margin-top:10px;">
                <button onmousedown="event.preventDefault(); toggleRuby()" id="btn-ruby" class="active" style="width:100%;">
                    ä¸€æ‹¬è¡¨ç¤º / éè¡¨ç¤º
                </button>
            </div>
        </div>

        <!-- è¡¨ç¤ºãƒ»å°åˆ· -->
        <div class="tool-group" style="margin-top: auto; border:none;">
            <div class="tool-label">å‡ºåŠ›ãƒ»è¡¨ç¤º</div>
            <button onclick="toggleWebMode()">ğŸŒ Webã‚µã‚¤ãƒˆã¨ã—ã¦è¡¨ç¤º</button>
            <button onclick="window.print()" class="primary-btn">ğŸ–¨ å°åˆ·ã™ã‚‹</button>
        </div>
    </div>

    <!-- Webãƒ¢ãƒ¼ãƒ‰è§£é™¤ãƒœã‚¿ãƒ³ï¼ˆæ­¯è»Šï¼šå·¦ä¸‹ï¼‰ -->
    <div class="gear-btn" onclick="toggleWebMode()" title="ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã‚‹">âš™</div>

    <!-- ã‚½ãƒ¼ã‚¹ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal-overlay" id="sourceModal">
        <div class="modal-content">
            <div class="modal-header">HTMLã‚½ãƒ¼ã‚¹ã®ç·¨é›†</div>
            <div style="font-size:12px; color:#666; margin-bottom:5px;">
                ã“ã“ã«å…ƒã®HTMLã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ã€Œåæ˜ ã™ã‚‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
            </div>
            <textarea id="htmlSourceInput" placeholder="<html>...</html>"></textarea>
            <div style="display:flex; justify-content:flex-end; gap:10px;">
                <button onclick="closeSourceModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button onclick="applySource()" class="primary-btn">åæ˜ ã™ã‚‹</button>
            </div>
        </div>
    </div>

    <!-- ãƒ«ãƒ“ç·¨é›†ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼ˆæ–°è¦è¿½åŠ ï¼‰ -->
    <div id="ruby-popup">
        <div class="popup-title">ãƒ«ãƒ“ã®ç·¨é›†</div>
        <div class="popup-kanji" id="popup-kanji-text"></div>
        <input type="text" id="popup-ruby-input" placeholder="èª­ã¿ä»®åã‚’å…¥åŠ›">
        <div class="popup-btns">
            <button class="btn-delete" onclick="deleteRuby()">ğŸ—‘ ãƒ«ãƒ“ã‚’å‰Šé™¤</button>
            <button class="primary-btn" onclick="applyRubyEdit()">âœ” å¤‰æ›´ã™ã‚‹</button>
        </div>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ -->
    <div class="main-area">
        <!-- ç·¨é›†ç”¨ç´™ (A4) -->
        <div id="paper-container" contenteditable="true">
            
            <!-- ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ -->
            <div class="instruction-banner no-print" contenteditable="false">
                <strong>ã€ã“ã“ã«HTMLã‚’èª­ã¿è¾¼ã‚€ãƒ»ç·¨é›†ã™ã‚‹ã€‘</strong>
                ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã¯ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚<br>
                ãƒ»æ–‡ç« ã‚„è¡¨ã®ä¸­èº«ã¯ã€ã“ã®ç”»é¢ã§ç›´æ¥ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ›¸ãæ›ãˆã‚‰ã‚Œã¾ã™ã€‚<br>
                ãƒ»æ—¢å­˜ã®ãƒ«ãƒ“ï¼ˆæŒ¯ã‚Šä»®åï¼‰ã¯<strong>ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã ã‘ã§ç·¨é›†ãƒ»å‰Šé™¤</strong>ã§ãã¾ã™ã€‚<br>
                ãƒ»ãƒ«ãƒ“ã‚’æ–°ã—ãä»˜ã‘ãŸã„å ´åˆã¯ã€æ–‡å­—ã‚’é¸æŠã—ã¦ã‹ã‚‰å·¦ã®ã€Œãƒ«ãƒ“ã‚’æŒ¯ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚
            </div>

            <!-- â–¼â–¼â–¼ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é–‹å§‹ â–¼â–¼â–¼ -->
            <div id="editable-content">
                <h1 class="doc-title"><ruby>å®Ÿ<rt>ã˜ã¤</rt></ruby><ruby>ç”¨<rt>ã‚ˆã†</rt></ruby><ruby>çš„<rt>ã¦ã</rt></ruby><ruby>èª­<rt>ã©</rt></ruby><ruby>è§£<rt>ã‹ã„</rt></ruby>ãƒ»<ruby>è¨ˆ<rt>ã‘ã„</rt></ruby><ruby>ç®—<rt>ã•ã‚“</rt></ruby>ãƒ—ãƒªãƒ³ãƒˆï¼š<ruby>ä¿®<rt>ã—ã‚…ã†</rt></ruby><ruby>å­¦<rt>ãŒã</rt></ruby><ruby>æ—…<rt>ã‚Šã‚‡</rt></ruby><ruby>è¡Œ<rt>ã“ã†</rt></ruby>ã®<ruby>è¨ˆ<rt>ã‘ã„</rt></ruby><ruby>ç”»<rt>ã‹ã</rt></ruby></h1>

                <div class="situation-box">
                    <strong>ã€ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã€‘</strong><br>
                    ã‚ãªãŸã¯<ruby>æ¥<rt>ã‚‰ã„</rt></ruby><ruby>é€±<rt>ã—ã‚…ã†</rt></ruby>ã€<ruby>äº¬<rt>ãã‚‡ã†</rt></ruby><ruby>éƒ½<rt>ã¨</rt></ruby>ã¸<ruby>ä¿®<rt>ã—ã‚…ã†</rt></ruby><ruby>å­¦<rt>ãŒã</rt></ruby><ruby>æ—…<rt>ã‚Šã‚‡</rt></ruby><ruby>è¡Œ<rt>ã“ã†</rt></ruby>ã«<ruby>è¡Œ<rt>ã„</rt></ruby>ãã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚ãªãŸã®<ruby>ç­<rt>ã¯ã‚“</rt></ruby>ãŒ<ruby>ä½œæˆ<rt>ã•ãã›ã„</rt></ruby>ã—ãŸï¼’<ruby>æ—¥<rt>ã«ã¡</rt></ruby><ruby>ç›®<rt>ã‚</rt></ruby>ã®<ruby>ç­<rt>ã¯ã‚“</rt></ruby><ruby>åˆ¥<rt>ã¹ã¤</rt></ruby><ruby>æ´»<rt>ã‹ã¤</rt></ruby><ruby>å‹•<rt>ã©ã†</rt></ruby>ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«<ruby>è¡¨<rt>ã²ã‚‡ã†</rt></ruby>ã§ã™ã€‚ã“ã®<ruby>è¡¨<rt>ã²ã‚‡ã†</rt></ruby>ã‚’ã‚ˆã<ruby>èª­<rt>ã‚ˆ</rt></ruby>ã‚“ã§ã€ã‚ã¨ã®<ruby>å•<rt>ã¨</rt></ruby>ã„ã«<ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆãªã•ã„ã€‚
                </div>

                <table class="doc-table">
                    <thead>
                        <tr>
                            <th style="width: 15%;"><ruby>æ™‚åˆ»<rt>ã˜ã“ã</rt></ruby></th>
                            <th style="width: 40%;"><ruby>è¡Œ<rt>ã„</rt></ruby>ã<ruby>å ´æ‰€<rt>ã°ã—ã‚‡</rt></ruby>ãƒ»ã™ã‚‹ã“ã¨</th>
                            <th><ruby>äº¤é€š<rt>ã“ã†ã¤ã†</rt></ruby><ruby>æ‰‹æ®µ<rt>ã—ã‚…ã ã‚“</rt></ruby>ã‚„<ruby>æ³¨æ„ç‚¹<rt>ã¡ã‚…ã†ã„ã¦ã‚“</rt></ruby></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>8:30</td>
                            <td><ruby>å®¿<rt>ã—ã‚…ã</rt></ruby><ruby>æ³Š<rt>ã¯ã</rt></ruby>ãƒ›ãƒ†ãƒ«<ruby>å‡ºç™º<rt>ã—ã‚…ã£ã±ã¤</rt></ruby></td>
                            <td>â€»<ruby>åœ°å›³<rt>ã¡ãš</rt></ruby>ã¨ã‚«ãƒ¡ãƒ©ã‚’<ruby>å¿˜<rt>ã‚ã™</rt></ruby>ã‚Œãªã„</td>
                        </tr>
                        <tr>
                            <td>9:10</td>
                            <td><ruby>é‡‘<rt>ãã‚“</rt></ruby><ruby>é–£<rt>ã‹ã</rt></ruby><ruby>å¯º<rt>ã˜</rt></ruby>ï¼ˆ<ruby>é¹¿<rt>ã‚ã</rt></ruby><ruby>è‹‘<rt>ãŠã‚“</rt></ruby><ruby>å¯º<rt>ã˜</rt></ruby>ï¼‰</td>
                            <td>ã€<ruby>å¸‚<rt>ã—</rt></ruby>ãƒã‚¹ã€ã‚’<ruby>åˆ©ç”¨<rt>ã‚Šã‚ˆã†</rt></ruby></td>
                        </tr>
                        <tr>
                            <td>11:00</td>
                            <td><ruby>åµ<rt>ã‚ã‚‰ã—</rt></ruby><ruby>å±±<rt>ã‚„ã¾</rt></ruby>ãƒ»<ruby>æ¸¡<rt>ã‚ãŸ</rt></ruby><ruby>æœˆ<rt>ã’ã¤</rt></ruby><ruby>æ©‹<rt>ãã‚‡ã†</rt></ruby></td>
                            <td>ã€<ruby>äº¬<rt>ã‘ã„</rt></ruby><ruby>ç¦<rt>ãµã</rt></ruby><ruby>é›»<rt>ã§ã‚“</rt></ruby><ruby>é‰„<rt>ã¦ã¤</rt></ruby>ï¼ˆ<ruby>åµ<rt>ã‚‰ã‚“</rt></ruby><ruby>é›»<rt>ã§ã‚“</rt></ruby>ï¼‰ã€</td>
                        </tr>
                        <tr>
                            <td>12:30</td>
                            <td><ruby>æ˜¼é£Ÿ<rt>ã¡ã‚…ã†ã—ã‚‡ã</rt></ruby>ï¼ˆãŠ<ruby>åº—<rt>ã¿ã›</rt></ruby>ï¼šã¿ã‚„ã“ï¼‰</td>
                            <td>â€»12:30ã«<ruby>äºˆç´„<rt>ã‚ˆã‚„ã</rt></ruby>ãšã¿</td>
                        </tr>
                        <tr>
                            <td>14:30</td>
                            <td><ruby>æ¸…<rt>ãã‚ˆ</rt></ruby><ruby>æ°´<rt>ã¿ãš</rt></ruby><ruby>å¯º<rt>ã§ã‚‰</rt></ruby></td>
                            <td>ã€ã‚¿ã‚¯ã‚·ãƒ¼ã€ã‚’<ruby>åˆ©ç”¨<rt>ã‚Šã‚ˆã†</rt></ruby></td>
                        </tr>
                        <tr>
                            <td>17:00</td>
                            <td><ruby>å®¿<rt>ã—ã‚…ã</rt></ruby><ruby>æ³Š<rt>ã¯ã</rt></ruby>ãƒ›ãƒ†ãƒ«<ruby>å¸°ç€<rt>ãã¡ã‚ƒã</rt></ruby></td>
                            <td>â€»<ruby>å¤•<rt>ã‚†ã†</rt></ruby><ruby>é£Ÿ<rt>ã—ã‚‡ã</rt></ruby>ã¯18:00ã‹ã‚‰</td>
                        </tr>
                    </tbody>
                </table>

                <div class="question-box">
                    <div class="question-title">
                        ã€<ruby>å•<rt>ã¨ã„</rt></ruby>1ã€‘ <ruby>å®¿<rt>ã—ã‚…ã</rt></ruby><ruby>æ³Š<rt>ã¯ã</rt></ruby>ãƒ›ãƒ†ãƒ«ã‚’<ruby>å‡ºç™º<rt>ã—ã‚…ã£ã±ã¤</rt></ruby>ã™ã‚‹ã¨ãã«ã€<ruby>å¿…<rt>ã‹ãªã‚‰</rt></ruby>ãš<ruby>æŒ<rt>ã‚‚</rt></ruby>ã£ã¦ã„ãã‚ˆã†ã«<ruby>æ›¸<rt>ã‹</rt></ruby>ã‹ã‚Œã¦ã„ã‚‹ã€Œ<ruby>æŒ<rt>ã‚‚</rt></ruby>ã¡<ruby>ç‰©<rt>ã‚‚ã®</rt></ruby>ã€ã‚’ï¼’ã¤<ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆãªã•ã„ã€‚
                    </div>
                    <div>
                        <ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆï¼š<span class="answer-space"></span>
                    </div>
                </div>

                <div class="question-box">
                    <div class="question-title">
                        ã€<ruby>å•<rt>ã¨ã„</rt></ruby>2ã€‘ <ruby>åµ<rt>ã‚ã‚‰ã—</rt></ruby><ruby>å±±<rt>ã‚„ã¾</rt></ruby>ã«<ruby>åˆ°ç€<rt>ã¨ã†ã¡ã‚ƒã</rt></ruby>ã—ã¦ã‹ã‚‰ã€<ruby>æ˜¼é£Ÿ<rt>ã¡ã‚…ã†ã—ã‚‡ã</rt></ruby>ã®ãŠ<ruby>åº—<rt>ã¿ã›</rt></ruby>ã«<ruby>è¡Œ<rt>ã„</rt></ruby>ãã¾ã§ã®ã€Œ<ruby>è‡ªç”±<rt>ã˜ã‚†ã†</rt></ruby><ruby>æ™‚é–“<rt>ã˜ã‹ã‚“</rt></ruby>ã€ã¯ã€<ruby>ä½•<rt>ãªã‚“</rt></ruby><ruby>åˆ†<rt>ã·ã‚“</rt></ruby><ruby>é–“<rt>ã‹ã‚“</rt></ruby>ã‚ã‚Šã¾ã™ã‹ã€‚
                    </div>
                    <div>
                        <ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆï¼š<span class="answer-space"></span><ruby>åˆ†<rt>ã·ã‚“</rt></ruby><ruby>é–“<rt>ã‹ã‚“</rt></ruby>
                    </div>
                </div>

                <div class="question-box">
                    <div class="question-title">
                        ã€<ruby>å•<rt>ã¨ã„</rt></ruby>3ã€‘ <ruby>æœ€å¾Œ<rt>ã•ã„ã”</rt></ruby>ã®<ruby>è¦‹å­¦<rt>ã‘ã‚“ãŒã</rt></ruby><ruby>å ´æ‰€<rt>ã°ã—ã‚‡</rt></ruby>ã§ã‚ã‚‹ã€Œ<ruby>æ¸…<rt>ãã‚ˆ</rt></ruby><ruby>æ°´<rt>ã¿ãš</rt></ruby><ruby>å¯º<rt>ã§ã‚‰</rt></ruby>ã€ã«<ruby>åˆ°ç€<rt>ã¨ã†ã¡ã‚ƒã</rt></ruby>ã™ã‚‹<ruby>äºˆå®š<rt>ã‚ˆã¦ã„</rt></ruby><ruby>æ™‚åˆ»<rt>ã˜ã“ã</rt></ruby>ã‚’<ruby>è¡¨<rt>ã‚ã‚‰ã‚</rt></ruby>ã—ã¦ã„ã‚‹<ruby>æ™‚è¨ˆ<rt>ã¨ã‘ã„</rt></ruby>ã‚’ã€<ruby>æ¬¡<rt>ã¤ã</rt></ruby>ã®ã‚¢ï½ã‚¨ã‹ã‚‰ï¼‘ã¤<ruby>é¸<rt>ãˆã‚‰</rt></ruby>ã‚“ã§ã€<ruby>è¨˜å·<rt>ãã”ã†</rt></ruby>ã§<ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆãªã•ã„ã€‚
                    </div>
                    <div class="clock-grid">
                        <div class="clock-item">
                            <canvas id="clockA" width="100" height="100"></canvas>
                            ã‚¢
                        </div>
                        <div class="clock-item">
                            <canvas id="clockB" width="100" height="100"></canvas>
                            ã‚¤
                        </div>
                        <div class="clock-item">
                            <canvas id="clockC" width="100" height="100"></canvas>
                            ã‚¦
                        </div>
                        <div class="clock-item">
                            <canvas id="clockD" width="100" height="100"></canvas>
                            ã‚¨
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆï¼š<span class="answer-space" style="min-width: 50px;"></span>
                    </div>
                </div>

                <div class="question-box">
                    <div class="question-title">
                        ã€<ruby>å•<rt>ã¨ã„</rt></ruby>4ã€‘ <ruby>è¨ˆç”»<rt>ã‘ã„ã‹ã</rt></ruby><ruby>ä¸­<rt>ã¡ã‚…ã†</rt></ruby>ã«ã€Œ<ruby>å¸‚<rt>ã—</rt></ruby>ãƒã‚¹ã€ã‚’<ruby>åˆ©ç”¨<rt>ã‚Šã‚ˆã†</rt></ruby>ã™ã‚‹<ruby>å ´é¢<rt>ã°ã‚ã‚“</rt></ruby>ãŒã‚ã‚Šã¾ã™ãŒã€ãƒã‚¹ã®<ruby>ä¸­<rt>ãªã‹</rt></ruby>ã§ã®<ruby>è¡Œå‹•<rt>ã“ã†ã©ã†</rt></ruby>ã¨ã—ã¦ã€Œã‚‚ã£ã¨ã‚‚ãµã•ã‚ã—ã„ã‚‚ã®ã€ã‚’ï¼‘ã¤<ruby>é¸<rt>ãˆã‚‰</rt></ruby>ã³ãªã•ã„ã€‚
                    </div>
                    <ul class="options">
                        <li>ã‚¢ï¼š<ruby>æ¬¡<rt>ã¤ã</rt></ruby>ã®<ruby>ç›®çš„åœ°<rt>ã‚‚ãã¦ãã¡</rt></ruby>ã‚’<ruby>ç¢ºèª<rt>ã‹ãã«ã‚“</rt></ruby>ã™ã‚‹ãŸã‚ã€<ruby>å¤§<rt>ãŠãŠ</rt></ruby>ããª<ruby>å£°<rt>ã“ãˆ</rt></ruby>ã§<ruby>ç›¸è«‡<rt>ãã†ã ã‚“</rt></ruby>ã™ã‚‹ã€‚</li>
                        <li>ã‚¤ï¼šãŠ<ruby>è…¹<rt>ãªã‹</rt></ruby>ãŒã™ã„ãŸã®ã§ã€<ruby>å‹é”<rt>ã¨ã‚‚ã ã¡</rt></ruby>ã¨ãŠ<ruby>è“å­<rt>ã‹ã—</rt></ruby>ã‚’<ruby>åˆ†<rt>ã‚</rt></ruby>ã‘<ruby>åˆ<rt>ã‚</rt></ruby>ã£ã¦<ruby>é£Ÿ<rt>ãŸ</rt></ruby>ã¹ã‚‹ã€‚</li>
                        <li>ã‚¦ï¼šãƒªãƒ¥ãƒƒã‚¯ã‚µãƒƒã‚¯ã‚’<ruby>èƒŒè² <rt>ã›ãŠ</rt></ruby>ã£ãŸã¾ã¾ã ã¨<ruby>ä»–<rt>ã»ã‹</rt></ruby>ã®<ruby>å®¢<rt>ãã‚ƒã</rt></ruby>ã®<ruby>é‚ªé­”<rt>ã˜ã‚ƒã¾</rt></ruby>ã«ãªã‚‹ã®ã§ã€<ruby>å‰<rt>ã¾ãˆ</rt></ruby>ã«<ruby>æŠ±<rt>ã‹ã‹</rt></ruby>ãˆãŸã‚Š<ruby>ç¶²æ£š<rt>ã‚ã¿ã ãª</rt></ruby>ã«<ruby>ç½®<rt>ãŠ</rt></ruby>ã„ãŸã‚Šã™ã‚‹ã€‚</li>
                        <li>ã‚¨ï¼š<ruby>é™<rt>ãŠ</rt></ruby>ã‚Šã‚‹<ruby>åœç•™æ‰€<rt>ã¦ã„ã‚Šã‚…ã†ã˜ã‚‡</rt></ruby>ã«<ruby>ç€<rt>ã¤</rt></ruby>ã<ruby>å‰<rt>ã¾ãˆ</rt></ruby>ã«ã€<ruby>æ€¥<rt>ã„ã</rt></ruby>ã„ã§ãƒã‚¹ã®<ruby>å‡ºå£<rt>ã§ãã¡</rt></ruby>ã¾ã§<ruby>èµ°<rt>ã¯ã—</rt></ruby>ã£ã¦<ruby>ç§»å‹•<rt>ã„ã©ã†</rt></ruby>ã™ã‚‹ã€‚</li>
                    </ul>
                    <div>
                        <ruby>ç­”<rt>ã“ãŸ</rt></ruby>ãˆï¼š<span class="answer-space" style="min-width: 50px;"></span>
                    </div>
                </div>
            </div>
            <!-- â–²â–²â–² ã‚³ãƒ³ãƒ†ãƒ³ãƒ„çµ‚äº† â–²â–²â–² -->

        </div>
    </div>

<script>
    /**
     * ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
     */

    const paper = document.getElementById('paper-container');
    let savedRange = null;

    // =========================================
    // ãƒ«ãƒ“ç·¨é›†ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é–¢é€£
    // =========================================
    const rubyPopup = document.getElementById('ruby-popup');
    const popupKanjiText = document.getElementById('popup-kanji-text');
    const popupRubyInput = document.getElementById('popup-ruby-input');
    let currentRubyEl = null; // ç¾åœ¨ç·¨é›†ä¸­ã®<ruby>è¦ç´ 

    /**
     * <ruby>è¦ç´ ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç”¨ç´™å…¨ä½“ã§æ•æ‰ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒªã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
     * contenteditableå†…ã§ã®ã‚¯ãƒªãƒƒã‚¯ã¯ã€é€šå¸¸ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ãŸã‚
     * mousedownã§ preventDefault ã—ã¦ã‚¯ãƒªãƒƒã‚¯åˆ¤å®šã™ã‚‹ã€‚
     */
    paper.addEventListener('mousedown', function(e) {
        // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸè¦ç´ ã¾ãŸã¯ãã®ç¥–å…ˆãŒ<ruby>ã‹åˆ¤å®š
        const rubyEl = e.target.closest('ruby');
        if (rubyEl && paper.contains(rubyEl)) {
            // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒæ—¢ã«é–‹ã„ã¦ã„ã¦åŒã˜è¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆã¯é–‰ã˜ã‚‹
            if (currentRubyEl === rubyEl && rubyPopup.classList.contains('visible')) {
                closeRubyPopup();
                return;
            }
            e.preventDefault(); // ã‚«ãƒ¼ã‚½ãƒ«ãŒrubyå†…ã«ç§»å‹•ã™ã‚‹ã®ã‚’é˜²ã
            openRubyPopup(rubyEl, e);
        } else {
            // rubyä»¥å¤–ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‰ã˜ã‚‹
            closeRubyPopup();
        }
    });

    function openRubyPopup(rubyEl, e) {
        // å‰ã®ç·¨é›†ä¸­ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤
        if (currentRubyEl) currentRubyEl.classList.remove('ruby-editing');

        currentRubyEl = rubyEl;
        currentRubyEl.classList.add('ruby-editing');

        // æ¼¢å­—ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ<rt>ä»¥å¤–ã®ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’å–å¾—
        const kanjiText = getKanjiText(rubyEl);
        // ç¾åœ¨ã®ãƒ«ãƒ“ï¼ˆ<rt>ã®å†…å®¹ï¼‰ã‚’å–å¾—
        const rtEl = rubyEl.querySelector('rt');
        const currentRuby = rtEl ? rtEl.textContent : '';

        popupKanjiText.textContent = kanjiText;
        popupRubyInput.value = currentRuby;

        // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®ä½ç½®ã‚’è¨ˆç®—ï¼ˆã‚¯ãƒªãƒƒã‚¯ä½ç½®ã®è¿‘ãã€ç”»é¢ã‹ã‚‰ã¯ã¿å‡ºã•ãªã„ã‚ˆã†èª¿æ•´ï¼‰
        rubyPopup.classList.add('visible');
        const rect = rubyEl.getBoundingClientRect();
        const popupRect = rubyPopup.getBoundingClientRect();

        let top = rect.bottom + window.scrollY + 6;
        let left = rect.left + window.scrollX;

        // ç”»é¢å³ç«¯ã‹ã‚‰ã¯ã¿å‡ºã™å ´åˆã¯å·¦å¯„ã›èª¿æ•´
        if (left + 220 > window.innerWidth) {
            left = window.innerWidth - 230;
        }
        // ç”»é¢ä¸‹ç«¯ã‹ã‚‰ã¯ã¿å‡ºã™å ´åˆã¯ä¸Šã«è¡¨ç¤º
        if (top + 130 > window.innerHeight + window.scrollY) {
            top = rect.top + window.scrollY - 130;
        }

        rubyPopup.style.top = top + 'px';
        rubyPopup.style.left = left + 'px';

        // inputã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼ˆå°‘ã—é…å»¶ã‚’å…¥ã‚Œãªã„ã¨ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ˆã£ã¦å‹•ä½œã—ãªã„ï¼‰
        setTimeout(() => popupRubyInput.focus(), 50);
    }

    function closeRubyPopup() {
        if (currentRubyEl) {
            currentRubyEl.classList.remove('ruby-editing');
            currentRubyEl = null;
        }
        rubyPopup.classList.remove('visible');
    }

    // <ruby>è¦ç´ ã‹ã‚‰æ¼¢å­—ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ<rt>ã‚’é™¤ãï¼‰ã‚’å–å¾—
    function getKanjiText(rubyEl) {
        let text = '';
        rubyEl.childNodes.forEach(node => {
            if (node.nodeType === Node.TEXT_NODE) {
                text += node.textContent;
            } else if (node.tagName && node.tagName.toLowerCase() !== 'rt') {
                text += node.textContent;
            }
        });
        return text;
    }

    // ãƒ«ãƒ“ã®å¤‰æ›´ã‚’é©ç”¨
    function applyRubyEdit() {
        if (!currentRubyEl) return;
        const newRuby = popupRubyInput.value.trim();
        const rtEl = currentRubyEl.querySelector('rt');
        if (rtEl) {
            rtEl.textContent = newRuby;
        } else {
            // <rt>ãŒãªã‘ã‚Œã°ä½œæˆ
            const newRt = document.createElement('rt');
            newRt.textContent = newRuby;
            currentRubyEl.appendChild(newRt);
        }
        closeRubyPopup();
    }

    // ãƒ«ãƒ“ã‚’å‰Šé™¤ï¼ˆ<ruby>ã‚¿ã‚°ã‚’ãƒ†ã‚­ã‚¹ãƒˆã«æˆ»ã™ï¼‰
    function deleteRuby() {
        if (!currentRubyEl) return;
        const kanjiText = getKanjiText(currentRubyEl);
        const textNode = document.createTextNode(kanjiText);
        currentRubyEl.parentNode.replaceChild(textNode, currentRubyEl);
        closeRubyPopup();
    }

    // Enterã‚­ãƒ¼ã§ç¢ºå®šã€Escapeã§é–‰ã˜ã‚‹
    popupRubyInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            applyRubyEdit();
        } else if (e.key === 'Escape') {
            closeRubyPopup();
        }
    });

    // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å†…ã®ã‚¯ãƒªãƒƒã‚¯ã¯ç”¨ç´™ã®mousedownãŒæ‹¾ã‚ãªã„ã‚ˆã†ä¼æ’­ã‚’æ­¢ã‚ã‚‹
    rubyPopup.addEventListener('mousedown', function(e) {
        e.stopPropagation();
    });

    // =========================================
    // é¸æŠç¯„å›²ã®ä¿å­˜ãƒ»å¾©å…ƒ
    // =========================================
    function saveSelection() {
        const selection = window.getSelection();
        if (selection.rangeCount > 0) {
            const range = selection.getRangeAt(0);
            if (paper.contains(range.commonAncestorContainer)) {
                savedRange = range;
                updateCurrentElementInfo(range.commonAncestorContainer);
            }
        }
    }

    function restoreSelection() {
        if (savedRange) {
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(savedRange);
        }
    }

    function updateCurrentElementInfo(node) {
        let el = (node.nodeType === 3) ? node.parentNode : node;
        const size = window.getComputedStyle(el).fontSize;
        if(size) document.getElementById('fontSizeInput').value = parseInt(size);
    }

    paper.addEventListener('keyup', saveSelection);
    paper.addEventListener('mouseup', saveSelection);
    paper.addEventListener('blur', saveSelection);

    // =========================================
    // ãƒ•ã‚©ãƒ³ãƒˆãƒ»æ›¸å¼
    // =========================================
    function toggleFont(type) {
        restoreSelection();
        document.body.classList.remove('font-gothic', 'font-mincho');
        document.body.classList.add('font-' + type);
        document.getElementById('btn-gothic').classList.toggle('active', type === 'gothic');
        document.getElementById('btn-mincho').classList.toggle('active', type === 'mincho');
        paper.focus();
    }

    // =========================================
    // ãƒ«ãƒ“ã‚’æ–°è¦ã«æŒ¯ã‚‹æ©Ÿèƒ½
    // =========================================
    function setRuby() {
        restoreSelection();
        const selection = window.getSelection();
        if (selection.rangeCount === 0 || selection.isCollapsed) {
            alert("ãƒ«ãƒ“ã‚’æŒ¯ã‚ŠãŸã„æ–‡å­—ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
            return;
        }

        const text = selection.toString();
        const rubyText = prompt("ã€Œ" + text + "ã€ã®ãƒ«ãƒ“ï¼ˆèª­ã¿ä»®åï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:", "");

        if (rubyText !== null) {
            const html = `<ruby>${text}<rt>${rubyText}</rt></ruby>`;
            document.execCommand('insertHTML', false, html);
        }
        
        paper.focus();
        saveSelection();
    }

    // ãƒ«ãƒ“è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
    function toggleRuby() {
        restoreSelection();
        document.body.classList.toggle('hide-ruby');
        paper.focus();
    }

    // Webãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
    function toggleWebMode() {
        document.body.classList.toggle('mode-web');
        closeRubyPopup();
    }

    // ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
    function execCmd(command) {
        restoreSelection();
        document.execCommand(command, false, null);
        paper.focus();
        saveSelection();
    }

    // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´
    const fontSizeInput = document.getElementById('fontSizeInput');
    fontSizeInput.addEventListener('change', function() {
        restoreSelection(); 
        const size = this.value + 'px';
        applyStyleToSelection('fontSize', size);
        paper.focus();
        saveSelection();
    });

    function applyStyleToSelection(styleName, styleValue) {
        const selection = window.getSelection();
        if (!selection.rangeCount) return;
        const range = selection.getRangeAt(0);
        const span = document.createElement("span");
        span.style[styleName] = styleValue;
        try {
            range.surroundContents(span);
        } catch (e) {
            document.execCommand('styleWithCSS', false, true);
        }
    }
    
    // =========================================
    // ã‚½ãƒ¼ã‚¹ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«
    // =========================================
    const modal = document.getElementById('sourceModal');
    const sourceInput = document.getElementById('htmlSourceInput');
    const contentArea = document.getElementById('editable-content');

    function openSourceModal() {
        sourceInput.value = contentArea.innerHTML.trim();
        modal.classList.add('open');
    }

    function closeSourceModal() {
        modal.classList.remove('open');
    }

    function applySource() {
        contentArea.innerHTML = sourceInput.value;
        closeSourceModal();
        setTimeout(initClocks, 100);
    }

    // =========================================
    // æ™‚è¨ˆæç”»ãƒ­ã‚¸ãƒƒã‚¯
    // =========================================
    function drawClock(canvasId, hour, minute) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const radius = canvas.width / 2;
        const cx = radius;
        const cy = radius;

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.arc(cx, cy, radius - 2, 0, 2 * Math.PI);
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 2;
        ctx.stroke();

        for (let i = 0; i < 12; i++) {
            const angle = (i * 30) * Math.PI / 180;
            const x1 = cx + (radius - 10) * Math.sin(angle);
            const y1 = cy - (radius - 10) * Math.cos(angle);
            const x2 = cx + (radius - 2) * Math.sin(angle);
            const y2 = cy - (radius - 2) * Math.cos(angle);
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
        }

        const hourAngle = ((hour % 12) * 30 + (minute / 60) * 30) * Math.PI / 180;
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.lineTo(cx + (radius * 0.5) * Math.sin(hourAngle), cy - (radius * 0.5) * Math.cos(hourAngle));
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 4;
        ctx.lineCap = 'round';
        ctx.stroke();

        const minuteAngle = (minute * 6) * Math.PI / 180;
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.lineTo(cx + (radius * 0.8) * Math.sin(minuteAngle), cy - (radius * 0.8) * Math.cos(minuteAngle));
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.stroke();

        ctx.beginPath();
        ctx.arc(cx, cy, 3, 0, 2 * Math.PI);
        ctx.fillStyle = '#000';
        ctx.fill();
    }

    function initClocks() {
        drawClock('clockA', 15, 30);
        drawClock('clockB', 14, 30);
        drawClock('clockC', 6, 12);
        drawClock('clockD', 14, 0);
    }

    window.onload = function() {
        initClocks();
    };
</script>

</body>
</html>
